# Лабораторная работа №2.
Сложность Medium

## Запуск через виртуальное окружение
```
py -m venv venv
venv/Scripts/activate
py -m src.main
```
## Команды
`<>` - Обязательный ввод, `()` - Опциональный

- `cd <путь>` - Перемещение в указанную директорию
- `ls (-l) (путь)` - Информация о всех файлах в каталоге, `-l` для подробной информацции
- `cat <путь>` - Чтение файла по заданному пути
- `rm (-r) <путь>` - Удаление файла по заданному пути, `-r` для удаления каталога со всем содержимым (Потребуется дополнительное подтвержение **Y/n**)
- `cp (-r) <копируемый путь> <конечный путь>` - Копирование файла по заданному пути в указанный путь, `-r` для копирования заданной директории в указанную.
- `mv <перемещаемый путь> <конечный путь>` - Перемещение заданного файла или директории по заданному пути в указанный путь
- `undo` - Отмена одной последней команды по работе с файлами (`rm`, `mv`, `cp`, не для команд с архивами)
- `zip/tar <путь> <название>` - Создание архива (формата .zip или .tar.gz) из заданного пути и заданным названием
- `unzip/untar <путь>` - Распаковка архива (формата .zip или .tar.gz) по заданному пути в **текущую** директорию
- `grep (-r) (-i) <шаблон> <путь>` - Поиск шаблона в файле по заданному пути, `-r` для поиска в файлах заданного каталога. `-i` Если не нужно учитывать регистр
- `history (n)` - Вывод `n` последних команд пользователя, если не указывать число, то выведет до 16 последних команд

## Формат ввода
- Поддерживаются абсолютные и относительные пути для всех команд, также поддерживаются `/` и `\ ` между каталогами
- Флаги (`-r`, `-l`, `-i`) можно писать в любом порядке, другие аргументы строго по порядку выше
- Для завершения программы достаточно отправить пустой ввод
- Пробелы в названиях файлов и каталогов допускаются, но необходимо как либо выделять через `"` `"` (Например, выделить весь путь или только всё название)

## Исполнение вне программы
- Логи хранятся в файле `shell.log`, который автоматически создается в запускаемой директории
- Пример формата лога
```
[2025-10-22 12:35:50] rm -r tests/test_env/dir1
[2025-10-22 12:35:51] Y
[2025-10-22 12:35:51] Successfully executed
```
- История хранится в файле `.history`, который автоматически создается в запускаемой директории
- Удалённые с помощью `rm` файлы и каталоги хранятся в папке `.trash`, которая автоматически создается в запускаемой директории

# Код

## main.py
- Запуск программы в `run()`, создание папки `.trash`, цикл для ввода команд

## data.py
- Класс `Data`, который всегда хранит в себе исходную директорию, чтобы сохранять логи и историю
- Хранит в себе информацию о последней из команд с изменением файлов для `undo`, и производит откат при вводе пользователя

## execute.py
- Ввод для `execute()` команды пользователя
- Определяет команду, разделяет и принимает аргументы, исполняет команды или выдает ошибки
- Логгирует, сохраняет команды, информацию о командах с изменением файлом в объекте `data`

## confirmation.py
- Требование подтвеждения **Y/n** от пользователя в функции `confirm()`
- Используется при удалении каталога через `rm -r`
- Продолжается цикл, если пользователь не вводит нужный из вариантов

## grep.py
- Поиск шаблона в указанном файле в функции `grep()`
- При поиске в каталоге идёт обращение к каждому файлу через отдельный вызов функции
- Если файл не удалось прочитать - возврат ошибки

## constants.py
- Список текстов выводимых ошибок, а также сохраняемых в логи текстов

# Дополнение
- Для `undo` возможен только один откат только последней команды из `rm`, `cp`, `mv`
- При создании архива в названии не должно быть символов `/`, `\`, `:`, `?`, `*`, `"`, `<>`, `|` (Ограничения Windows)